@page "/plex/libraries"
@using smabPlayground2020.Shared.PlexInfo.Models
@inject PlexInfoClient plexClient
@inject PlexInfoState piState

<h3>Libraries</h3>

    @foreach (var item in items)
    {
    <div class="card h-100 m-1 library-card">
        <div class="card-body text-center">
            <img src="/PlexInfo/resource/@((item.Thumb ?? "video.png").Replace(@"/:/resources/", ""))" loading="lazy" class="library-image" alt="@item.Title"/>
            <div class="card-text font-weight-bold">@item.Title</div>
        </div>
    </div>
    }

@code {
    public string Message { get; set; } = "Loading libraries ...";

    private List<LibraryDirectory> items { get; set; } = new();

    protected override async Task OnInitializedAsync()
    {
        items = (await plexClient.GetLibraries())
            .MediaContainer.Directories?
            .Where(l => l.Hidden == 0)
            .OrderBy(l => l.Type)
            .ToList() ?? new();
    }
}
